(function(n){"use strict";function r(n,t){return this.bctx=null,this.bgPixel=null,this.ctx=null,this.diffChannel=null,this.container=t,this.grid=[],this.ngx=null,this.ngy=null,this.settings=n,this.size=null,this.words=[],this}var t="awesomeCloud",i={size:{grid:8,factor:0,normalize:!0},color:{background:"rgba(255,255,255,0)",start:"#20f",end:"#e00"},options:{color:"gradient",rotationRatio:.3,printMultiplier:1,sort:"highest"},font:"Helvetica, Arial, sans-serif",shape:"circle"};n.fn.awesomeCloud=function(u,f){if(typeof u=="object")f=u;else if(typeof u=="string"){var e=this.data("_"+t);return e?i[u]!==undefined?f!==undefined?(e.settings[u]=f,!0):e.settings[u]:!1:!1}return f=n.extend(!0,{},i,f||{}),this.each(function(){var i=n(this),e=jQuery.extend(!0,{},f),u=new r(e,i);u.create();i.data("_"+t,u)})};r.prototype={create:function(){var r=this,i=0,e=null,k=0,u=0,d=t+"TempCheck",o=null,c=!1,y=0,l=.1,p=0,a=0,w=0,f=0,s,h,g,v,b;this.settings.weightFactor=function(n){return n*r.settings.size.factor};this.settings.gridSize=Math.max(this.settings.size.grid,4)*this.settings.options.printMultiplier;this.settings.color.start=this.colorToRGBA(this.settings.color.start);this.settings.color.end=this.colorToRGBA(this.settings.color.end);this.settings.color.background=this.colorToRGBA(this.settings.color.background);this.settings.minSize=this.minimumFontSize();this.settings.ellipticity=1;switch(this.settings.shape){case"square":this.settings.shape=function(n){var t=(n+Math.PI/4)%(Math.PI/2);return 1/(Math.cos(t)+Math.sin(t))};break;case"diamond":this.settings.shape=function(n){var t=n%(Math.PI/2);return 1/(Math.cos(t)+Math.sin(t))};break;case"x":this.settings.shape=function(n){var t=n%(Math.PI/2);return 1/(Math.cos(t)+Math.sin(t)-Math.PI/2)};break;case"triangle":this.settings.shape=function(n){var t=(n+Math.PI*3/2)%(2*Math.PI/3);return 1/(Math.cos(t)+Math.sqrt(3)*Math.sin(t))};break;case"triangle-forward":this.settings.shape=function(n){var t=n%(2*Math.PI/3);return 1/(Math.cos(t)+Math.sqrt(3)*Math.sin(t))};break;case"pentagon":this.settings.shape=function(n){var t=(n+.955)%(2*Math.PI/5);return 1/(Math.cos(t)+.726543*Math.sin(t))};break;case"star":this.settings.shape=function(n){var t=(n+.955)%(Math.PI/5);return(n+.955)%(2*Math.PI/5)-Math.PI/5>=0?1/(Math.cos(Math.PI/5-t)+3.07768*Math.sin(Math.PI/5-t)):1/(Math.cos(t)+3.07768*Math.sin(t))};break;case"circle":default:this.settings.shape=function(){return 1}}if(this.size={left:this.container.offset().left,top:this.container.offset().top,height:this.container.height()*this.settings.options.printMultiplier,width:this.container.width()*this.settings.options.printMultiplier,screenHeight:this.container.height(),screenWidth:this.container.width()},this.settings.ellipticity=this.size.height/this.size.width,this.settings.ellipticity>2&&(this.settings.ellipticity=2),this.settings.ellipticity<.2&&(this.settings.ellipticity=.2),this.settings.weight={lowest:null,highest:null,average:null},this.container.children().each(function(t){u=parseInt(n(this).attr("data-weight"),10);k+=u;r.settings.weight.lowest||(r.settings.weight.lowest=u);r.settings.weight.highest||(r.settings.weight.highest=u);u<r.settings.weight.lowest&&(r.settings.weight.lowest=u);u>r.settings.weight.highest&&(r.settings.weight.highest=u);r.settings.weight.average=k/(t+1);n(this).css("display","none");r.words.push([n(this).html(),u])}),this.settings.range=this.settings.weight.highest-this.settings.weight.lowest,this.settings.size.normalize===!0)for(this.words.sort(function(n,t){return n[1]-t[1]}),i=0;i<this.words.length;i++)o===null?o=this.words[i][1]:this.words[i][1]-o>this.settings.weight.average&&(this.words[i][1]-=(this.words[i][1]-o)/(this.settings.weight.average*.38)+o);if(this.words.sort(function(n,t){return r.settings.options.sort==="random"?.5-Math.random():r.settings.options.sort==="lowest"?n[1]-t[1]:t[1]-n[1]}),this.settings.size.factor===parseInt(0,10)){for(this.settings.size.factor=1,e=t+"SizeTest",c=!1,y=0,l=.1,p=0,a=0,w=0,f=0,s=Math.min(this.size.width,this.size.height),h=this.createCanvas({id:e,width:s,height:s,left:0,top:0}),i=0;i<this.words.length;i++)h.font=this.settings.weightFactor(this.words[i][1])+"px "+this.settings.font,f=h.measureText(this.words[i][0]).width,f>p&&(p=f,a=this.words[i]);while(!c)y=this.settings.weightFactor(a[1]),h.font=y.toString(10)+"px "+this.settings.font,f=h.measureText(a[0]).width,f>s*.95?this.settings.size.factor-=l:f<s*.9?this.settings.size.factor+=l:c=!0,w++,w>1e4&&(c=!0);this.destroyCanvas(e);this.settings.size.factor-=l}if(this.settings.color.increment={r:(this.settings.color.end.r-this.settings.color.start.r)/this.settings.range,g:(this.settings.color.end.g-this.settings.color.start.g)/this.settings.range,b:(this.settings.color.end.b-this.settings.color.start.b)/this.settings.range,a:(this.settings.color.end.a-this.settings.color.start.a)/this.settings.range},this.ngx=Math.floor(this.size.width/this.settings.gridSize),this.ngy=Math.floor(this.size.height/this.settings.gridSize),this.grid=[],e=t+this.container.attr("id"),this.ctx=this.createCanvas({parent:this.container,id:e,width:this.size.width,height:this.size.height,left:"0px",top:"0px"}),this.bctx=this.createCanvas({id:d,width:1,height:1,left:0,top:0}),this.bctx.fillStyle=this.settings.color.background.rgba,this.bctx.clearRect(0,0,1,1),this.bctx.fillStyle=this.settings.color.background.rgba,this.bctx.fillRect(0,0,1,1),this.bgPixel=this.bctx.getImageData(0,0,1,1).data,typeof this.settings.options.color!="function"&&this.settings.options.color.substr(0,6)!=="random"&&this.settings.options.color.substr(0,8)!=="gradient"){for(this.bctx.fillStyle=this.colorToRGBA(this.settings.options.color).rgba,this.bctx.fillRect(0,0,1,1),g=this.bctx.getImageData(0,0,1,1).data,i=4;i--;)if(Math.abs(g[i]-this.bgPixel[i])>10){this.diffChannel=i;break}}else this.diffChannel=NaN;for(this.destroyCanvas(d),v=this.ngx;v--;)for(this.grid[v]=[],b=this.ngy;b--;)this.grid[v][b]=!0;return this.ctx.fillStyle=this.settings.color.background.rgba,this.ctx.clearRect(0,0,this.ngx*(this.settings.gridSize+1),this.ngy*(this.settings.gridSize+1)),this.ctx.fillRect(0,0,this.ngx*(this.settings.gridSize+1),this.ngy*(this.settings.gridSize+1)),this.ctx.textBaseline="top",i=0,window.setImmediate(function nt(){i>=r.words.length||(r.putWord(r.words[i][0],r.words[i][1]),i++,window.setImmediate(nt))}),r.allDone(e),!0},allDone:function(t){n("#"+t).width(this.size.screenWidth);n("#"+t).height(this.size.screenHeight);n("#"+t).css("display","block");n("#"+t).css("visibility","visible")},minimumFontSize:function(){for(var r=t+"FontTest",n=this.createCanvas({id:r,width:50,height:50,left:0,top:0}),i=20,u,f;i;){if(n.font=i.toString(10)+"px sans-serif",n.measureText("Ｗ").width===u&&n.measureText("m").width===f)return this.destroyCanvas(r),(i+1)/2;u=n.measureText("Ｗ").width;f=n.measureText("m").width;i--}return this.destroyCanvas(r),0},createCanvas:function(t){var i=t.id,r,u=n("body");return t.parent!==undefined&&(u=t.parent),u.append('<canvas id="'+i+'" width="'+t.width+'" height="'+t.height+'">.<\/canvas>'),n("#"+i).css("visibility","hidden"),n("#"+i).css("display","none"),n("#"+i).css("position","relative"),n("#"+i).css("z-index",0),n("#"+i).width(t.width),n("#"+i).height(t.height),n("#"+i).offset({top:t.top,left:t.left}),r=document.getElementById(i),r.setAttribute("width",t.width),r.setAttribute("height",t.height),r.getContext("2d")},destroyCanvas:function(t){n("#"+t).remove()},putWord:function(n,i){var r=this,p=Math.random()<this.settings.options.rotationRatio,e=this.settings.weightFactor(i),u=null,f=null,s,h,w,c,l,a,v,b,d,o,y,k;if(e<=this.settings.minSize)return!1;for(this.ctx.font=e.toString(10)+"px "+this.settings.font,p?(u=this.ctx.measureText(n).width,f=Math.max(e,this.ctx.measureText("m").width,this.ctx.measureText("Ｗ").width),/[Jgpqy]/.test(n)&&(f*=3/2),f+=Math.floor(e/6),u+=Math.floor(e/6)):(f=this.ctx.measureText(n).width,u=Math.max(e,this.ctx.measureText("m").width,this.ctx.measureText("Ｗ").width),/[Jgpqy]/.test(n)&&(u*=3/2),u+=Math.floor(e/6),f+=Math.floor(e/6)),f=Math.ceil(f),u=Math.ceil(u),s=Math.ceil(f/this.settings.gridSize),h=Math.ceil(u/this.settings.gridSize),w=[this.ngx/2,this.ngy/2],c=Math.floor(Math.sqrt(this.ngx*this.ngx+this.ngy*this.ngy)),l=this.ngx+this.ngy,a=c+1;a--;){for(v=l,k=[];v--;)b=this.settings.shape(v/l*2*Math.PI),k.push([Math.floor(w[0]+(c-a)*b*Math.cos(-v/l*2*Math.PI)-s/2),Math.floor(w[1]+(c-a)*b*this.settings.ellipticity*Math.sin(-v/l*2*Math.PI)-h/2),v/l*2*Math.PI]);if(k.shuffle().some(function(l){return r.canFitText(l[0],l[1],s,h)?(p?(y=t+"Rotator",o=r.createCanvas({id:y,width:f,height:u,left:0,top:0}),d=document.getElementById(y),o.fillStyle=r.settings.color.background.rgba,o.fillRect(0,0,f,u),o.fillStyle=r.wordcolor(n,i,e,c-a,l[2]),o.font=e.toString(10)+"px "+r.settings.font,o.textBaseline="top",p&&(o.translate(0,u),o.rotate(-Math.PI/2)),o.fillText(n,Math.floor(e/6),0),r.ctx.clearRect(Math.floor(l[0]*r.settings.gridSize+(s*r.settings.gridSize-f)/2),Math.floor(l[1]*r.settings.gridSize+(h*r.settings.gridSize-u)/2),f,u),r.ctx.drawImage(d,Math.floor(l[0]*r.settings.gridSize+(s*r.settings.gridSize-f)/2),Math.floor(l[1]*r.settings.gridSize+(h*r.settings.gridSize-u)/2),f,u),r.destroyCanvas(y)):(r.ctx.font=e.toString(10)+"px "+r.settings.font,r.ctx.fillStyle=r.wordcolor(n,i,e,c-a,l[2]),r.ctx.fillText(n,l[0]*r.settings.gridSize+(s*r.settings.gridSize-f)/2,l[1]*r.settings.gridSize+(h*r.settings.gridSize-u)/2)),r.updateGrid(l[0],l[1],s,h),!0):!1}))return!0}return!1},canFitText:function(n,t,i,r){if(n<0||t<0||n+i>this.ngx||t+r>this.ngy)return!1;for(var f=i,u;f--;)for(u=r;u--;)if(!this.grid[n+f][t+u])return!1;return!0},wordcolor:function(n,t,i,r,u){var f=null;switch(this.settings.options.color){case"gradient":f="rgba("+Math.round(this.settings.color.start.r+this.settings.color.increment.r*(t-this.settings.weight.lowest))+","+Math.round(this.settings.color.start.g+this.settings.color.increment.g*(t-this.settings.weight.lowest))+","+Math.round(this.settings.color.start.b+this.settings.color.increment.b*(t-this.settings.weight.lowest))+","+Math.round(this.settings.color.start.a+this.settings.color.increment.a*(t-this.settings.weight.lowest))+")";break;case"random-dark":f="rgba("+Math.floor(Math.random()*128).toString(10)+","+Math.floor(Math.random()*128).toString(10)+","+Math.floor(Math.random()*128).toString(10)+",1)";break;case"random-light":f="rgba("+Math.floor(Math.random()*128+128).toString(10)+","+Math.floor(Math.random()*128+128).toString(10)+","+Math.floor(Math.random()*128+128).toString(10)+",1)";break;default:f=typeof this.settings.wordColor!="function"?"rgba(127,127,127,1)":this.settings.wordColor(n,t,i,r,u)}return f},updateGrid:function(n,t,i,r,u){for(var e=i,f,o=this.ctx.getImageData(n*this.settings.gridSize,t*this.settings.gridSize,i*this.settings.gridSize,r*this.settings.gridSize);e--;)for(f=r;f--;)this.isGridEmpty(o,e*this.settings.gridSize,f*this.settings.gridSize,i*this.settings.gridSize,r*this.settings.gridSize,u)||(this.grid[n+e][t+f]=!1)},isGridEmpty:function(n,t,i,r,u,f){var o=this.settings.gridSize,e,s;if(isNaN(this.diffChannel)||f){while(o--)for(e=this.settings.gridSize;e--;)for(s=4;s--;)if(this.getChannelData(n.data,t+o,i+e,r,u,s)!==this.bgPixel[s])return!1}else while(o--)for(e=this.settings.gridSize;e--;)if(this.getChannelData(n.data,t+o,i+e,r,u,this.diffChannel)!==this.bgPixel[this.diffChannel])return!1;return!0},getChannelData:function(n,t,i,r,u,f){return n[(i*r+t)*4+f]},colorToRGBA:function(n){n=n.replace(/^\s*#|\s*$/g,"");n.length===3&&(n=n.replace(/(.)/g,"$1$1"));n=n.toLowerCase();var c={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(n){return[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),1]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d+(?:\.\d+)?|\.\d+)\s*\)/,example:["rgb(123, 234, 45, 1)","rgb(255,234,245, 0.5)"],process:function(n){return[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseFloat(n[4])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(n){return[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),1]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(n){return[parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16),1]}}],t,i,r,u,s,f,l,a,h,e;for(s in c)n===s&&(n=c[s]);for(f=0;f<o.length;f++)l=o[f].re,a=o[f].process,h=l.exec(n),h&&(e=a(h),t=e[0],i=e[1],r=e[2],u=e[3]);return t=t<0||isNaN(t)?0:t>255?255:t,i=i<0||isNaN(i)?0:i>255?255:i,r=r<0||isNaN(r)?0:r>255?255:r,u=u<0||isNaN(u)?0:u>1?1:u,{r:t,g:i,b:r,a:u,rgba:"rgba("+t+", "+i+", "+r+", "+u+")"}}}})(jQuery);Array.prototype.shuffle=function(){"use strict";for(var t,i,n=this.length;n;t=parseInt(Math.random()*n,10),i=this[--n],this[n]=this[t],this[t]=i);return this};window.setImmediate||(window.setImmediate=function(){"use strict";return window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(window.postMessage&&window.addEventListener){var n=[],t=-1,i=-1,r="zero-timeout-message",f=function(t){return n.push(t),window.postMessage(r,"*"),++i},e=function(i){if(i.data===r&&(i.stopPropagation(),n.length>0)){var u=n.shift();u();t++}},u;return window.addEventListener("message",e,!0),window.clearImmediate=function(r){typeof r!="number"||r>i||(u=r-t-1,n[u]=function(){})},f}}()||function(n){window.setTimeout(n,0)}}());window.clearImmediate||(window.clearImmediate=function(){"use strict";return window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(n){window.clearTimeout(n)}}());
/*
//# sourceMappingURL=jquery.awesomeCloud.min.js.map
*/